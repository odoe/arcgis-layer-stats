import{bZ as U,fA as R,fB as z,eV as S,er as I,fC as $,fD as F,fE as A,fF as B,fG as w,fH as E,eM as V,G as D,_ as G,fI as J}from"./index.96cac272.js";import{i as K}from"./multiOriginJSONSupportUtils.38b69b9c.js";function g(e){return y[T(e)]||C}function T(e){return e instanceof Blob?e.type:k(e.url)}function k(e){const t=U(e);return d[t]||b}const y={},b="text/plain",C=y[b],d={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const e in d)y[d[e]]=e;function ee(e){var o;const t=(o=e==null?void 0:e.origins)!=null?o:[void 0];return(s,n)=>{const i=H(e,s,n);for(const a of t){const r=R(s,a,n);for(const c in i)r[c]=i[c]}}}function H(e,t,o){var s;if((e==null?void 0:e.type)==="resource")return L(e,t,o);switch((s=e==null?void 0:e.type)!=null?s:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:n,write:i}=J;return{read:n,write:i}}}}function L(e,t,o){const s=z(t,o);return{type:String,read:(n,i,a)=>{const r=S(n,i,a);return s.type===String?r:typeof s.type=="function"?new s.type({url:r}):void 0},write:{writer(n,i,a,r){if(!r||!r.resources)return typeof n=="string"?void(i[a]=I(n,r)):void(i[a]=n.write({},r));const c=Q(n),p=I(c,{...r,verifyItemRelativeUrls:r&&r.verifyItemRelativeUrls?{writtenUrls:r.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},$.NO),l=s.type!==String&&(!K(this)||r&&r.origin&&this.originIdOf(o)>F(r.origin)),u={object:this,propertyName:o,value:n,targetUrl:p,dest:i,targetPropertyName:a,context:r,params:e};r&&r.portalItem&&p&&!A(p)?l?M(u):Z(u):r&&r.portalItem&&(p==null||B(p)!=null||w(p)||l)?P(u):i[a]=p}}}}function P(e){var v,h,x;const{targetUrl:t,params:o,value:s,context:n,dest:i,targetPropertyName:a}=e;if(!n.portalItem)return;const r=E(t),c=(v=r==null?void 0:r.filename)!=null?v:V(),p=(h=o==null?void 0:o.prefix)!=null?h:r==null?void 0:r.prefix,l=N(s,t,n),u=D(p,c),f=`${u}.${g(l)}`,m=n.portalItem.resourceFromPath(f);w(t)&&n.resources&&n.resources.pendingOperations.push(q(t).then(O=>{m.path=`${u}.${g(O)}`,i[a]=m.itemRelativeUrl}).catch(()=>{}));const _=(x=o==null?void 0:o.compress)!=null?x:!1;n.resources&&j({...e,resource:m,content:l,compress:_,updates:n.resources.toAdd}),i[a]=m.itemRelativeUrl}function M(e){var f;const{context:t,targetUrl:o,params:s,value:n,dest:i,targetPropertyName:a}=e;if(!t.portalItem)return;const r=t.portalItem.resourceFromPath(o),c=N(n,o,t),p=g(c),l=U(r.path),u=(f=s==null?void 0:s.compress)!=null?f:!1;p===l?(t.resources&&j({...e,resource:r,content:c,compress:u,updates:t.resources.toUpdate}),i[a]=o):P(e)}function Z({context:e,targetUrl:t,dest:o,targetPropertyName:s}){e.portalItem&&e.resources&&(e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(t),compress:!1}),o[s]=t)}function j({object:e,propertyName:t,updates:o,resource:s,content:n,compress:i}){o.push({resource:s,content:n,compress:i,finish:a=>{W(e,t,a)}})}function N(e,t,o){return typeof e=="string"?{url:t}:new Blob([JSON.stringify(e.toJSON(o))],{type:"application/json"})}async function q(e){const t=(await G(()=>import("./index.96cac272.js").then(s=>s.h8),["assets/index.96cac272.js","assets/index.6fd87b6d.css"])).default,{data:o}=await t(e,{responseType:"blob"});return o}function Q(e){return e==null?null:typeof e=="string"?e:e.url}function W(e,t,o){typeof e[t]=="string"?e[t]=o.url:e[t].url=o.url}export{ee as g};
