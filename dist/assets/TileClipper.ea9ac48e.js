import{M as mi,_ as Kt,ac as di}from"./index.a113d2e4.js";import{X as gi,e as at,n as it,o as Ti}from"./enums.494fcfff.js";import{t as Q,s as mt}from"./Geometry.d049a63c.js";class ms{constructor(e=0,n=0,o=0,a=0){this.x=e,this.y=n,this.width=o,this.height=a}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}}const pi=128e3;let Qt=null,ai=null;async function ds(){return Qt||(Qt=Li()),Qt}async function Li(){ai=await(mi("esri-csp-restrictions")?await Kt(()=>import("./libtess-asm.35b825b8.js"),[]).then(e=>e.l):await Kt(()=>import("./libtess.1a722897.js"),[]).then(e=>e.l)).load({locateFile:e=>di(`esri/core/libs/libtess/${e}`)})}function gs(h,e){const n=Math.max(h.length,pi);return ai.triangulate(h,e,n)}function li(h,e){return h.x===e.x&&h.y===e.y}function wi(h){if(!h)return;const e=h.length;if(e<=1)return;let n=0;for(let o=1;o<e;o++)li(h[o],h[n])||++n===o||(h[n]=h[o]);h.length=n+1}function J(h,e){return h.x=e.y,h.y=-e.x,h}function H(h,e){return h.x=-e.y,h.y=e.x,h}function ti(h,e){return h.x=e.x,h.y=e.y,h}function Yt(h,e){return h.x=-e.x,h.y=-e.y,h}function Zt(h){return Math.sqrt(h.x*h.x+h.y*h.y)}function Ai(h,e){return h.x*e.y-h.y*e.x}function ii(h,e){return h.x*e.x+h.y*e.y}function Lt(h,e,n,o){return h.x=e.x*n+e.y*o,h.y=e.x*o-e.y*n,h}class Ts{constructor(e,n,o){this._writeVertex=e,this._writeTriangle=n,this._canUseThinTessellation=o,this._prevNormal={x:void 0,y:void 0},this._nextNormal={x:void 0,y:void 0},this._textureNormalLeft={x:0,y:1},this._textureNormalRight={x:0,y:-1},this._textureNormal={x:void 0,y:void 0},this._joinNormal={x:void 0,y:void 0},this._inner={x:void 0,y:void 0},this._outer={x:void 0,y:void 0},this._roundStart={x:void 0,y:void 0},this._roundEnd={x:void 0,y:void 0},this._startBreak={x:void 0,y:void 0},this._endBreak={x:void 0,y:void 0},this._innerPrev={x:void 0,y:void 0},this._innerNext={x:void 0,y:void 0},this._bevelStart={x:void 0,y:void 0},this._bevelEnd={x:void 0,y:void 0},this._bevelMiddle={x:void 0,y:void 0}}tessellate(e,n){wi(e),this._canUseThinTessellation&&n.halfWidth<gi&&!n.offset?this._tessellateThin(e,n):this._tessellate(e,n)}_tessellateThin(e,n){if(e.length<2)return;const o=n.wrapDistance||65535;let a=n.initialDistance||0,l=!1,x=e[0].x,c=e[0].y;const y=e.length;for(let m=1;m<y;++m){l&&(l=!1,a=0);let R=e[m].x,B=e[m].y,w=R-x,v=B-c,d=Math.sqrt(w*w+v*v);if(w/=d,v/=d,a+d>o){l=!0;const u=(o-a)/d;d=o-a,R=(1-u)*x+u*R,B=(1-u)*c+u*B,--m}const T=this._writeVertex(x,c,0,0,w,v,v,-w,0,-1,a),A=this._writeVertex(x,c,0,0,w,v,-v,w,0,1,a);a+=d;const b=this._writeVertex(R,B,0,0,w,v,v,-w,0,-1,a),f=this._writeVertex(R,B,0,0,w,v,-v,w,0,1,a);this._writeTriangle(T,A,b),this._writeTriangle(A,b,f),x=R,c=B}}_tessellate(e,n){const o=e[0],a=e[e.length-1],l=li(o,a),x=l?3:2;if(e.length<x)return;const c=n.pixelCoordRatio,y=n.capType!=null?n.capType:at.BUTT,m=n.joinType!=null?n.joinType:it.MITER,R=n.miterLimit!=null?Math.min(n.miterLimit,4):2,B=n.roundLimit!=null?Math.min(n.roundLimit,1.05):1.05,w=n.halfWidth!=null?n.halfWidth:2,v=!!n.textured;let d,T,A,b=null;const f=this._prevNormal,u=this._nextNormal;let dt=-1,_t=-1;const V=this._joinNormal;let M,$;const Vt=this._textureNormalLeft,Nt=this._textureNormalRight,D=this._textureNormal;let P=-1,E=-1;const Xt=n.wrapDistance||65535;let F=n.initialDistance||0;const ci=this._writeVertex,fi=this._writeTriangle,I=(Y,Et,ct,j,tt,nt)=>{const ht=ci(T,A,M,$,ct,j,Y,Et,tt,nt,F);return P>=0&&E>=0&&ht>=0&&fi(P,E,ht),P=E,E=ht,ht};l&&(d=e[e.length-2],u.x=a.x-d.x,u.y=a.y-d.y,_t=Zt(u),u.x/=_t,u.y/=_t);let gt=!1;for(let Y=0;Y<e.length;++Y){if(gt&&(gt=!1,F=0),d&&(f.x=-u.x,f.y=-u.y,dt=_t,F+dt>Xt&&(gt=!0)),gt){const U=(Xt-F)/dt;dt=Xt-F,d={x:(1-U)*d.x+U*e[Y].x,y:(1-U)*d.y+U*e[Y].y},--Y}else d=e[Y];T=d.x,A=d.y;const Et=Y<=0&&!gt,ct=Y===e.length-1;if(Et||(F+=dt),b=ct?l?e[1]:null:e[Y+1],b?(u.x=b.x-T,u.y=b.y-A,_t=Zt(u),u.x/=_t,u.y/=_t):(u.x=void 0,u.y=void 0),!l){if(Et){H(V,u),M=V.x,$=V.y,y===at.SQUARE&&(I(-u.y-u.x,u.x-u.y,u.x,u.y,0,-1),I(u.y-u.x,-u.x-u.y,u.x,u.y,0,1)),y===at.ROUND&&(I(-u.y-u.x,u.x-u.y,u.x,u.y,-1,-1),I(u.y-u.x,-u.x-u.y,u.x,u.y,-1,1)),y!==at.ROUND&&y!==at.BUTT||(I(-u.y,u.x,u.x,u.y,0,-1),I(u.y,-u.x,u.x,u.y,0,1));continue}if(ct){J(V,f),M=V.x,$=V.y,y!==at.ROUND&&y!==at.BUTT||(I(f.y,-f.x,-f.x,-f.y,0,-1),I(-f.y,f.x,-f.x,-f.y,0,1)),y===at.SQUARE&&(I(f.y-f.x,-f.x-f.y,-f.x,-f.y,0,-1),I(-f.y-f.x,f.x-f.y,-f.x,-f.y,0,1)),y===at.ROUND&&(I(f.y-f.x,-f.x-f.y,-f.x,-f.y,1,-1),I(-f.y-f.x,f.x-f.y,-f.x,-f.y,1,1));continue}}let j,tt,nt=-Ai(f,u);if(Math.abs(nt)<.01)ii(f,u)>0?(V.x=f.x,V.y=f.y,nt=1,j=Number.MAX_VALUE,tt=!0):(H(V,u),nt=1,j=1,tt=!1);else{V.x=(f.x+u.x)/nt,V.y=(f.y+u.y)/nt,j=Zt(V);const U=(j-1)*w*c;tt=j>4||U>dt&&U>_t}M=V.x,$=V.y;let ht=m;switch(m){case it.BEVEL:j<1.05&&(ht=it.MITER);break;case it.ROUND:j<B&&(ht=it.MITER);break;case it.MITER:j>R&&(ht=it.BEVEL)}switch(ht){case it.MITER:if(I(V.x,V.y,-f.x,-f.y,0,-1),I(-V.x,-V.y,-f.x,-f.y,0,1),ct)break;if(v){const U=gt?0:F;P=this._writeVertex(T,A,M,$,u.x,u.y,V.x,V.y,0,-1,U),E=this._writeVertex(T,A,M,$,u.x,u.y,-V.x,-V.y,0,1,U)}break;case it.BEVEL:{const U=nt<0;let C,z,xt,Z;if(U){const S=P;P=E,E=S,C=Vt,z=Nt}else C=Nt,z=Vt;if(tt)xt=U?H(this._innerPrev,f):J(this._innerPrev,f),Z=U?J(this._innerNext,u):H(this._innerNext,u);else{const S=U?Yt(this._inner,V):ti(this._inner,V);xt=S,Z=S}const G=U?J(this._bevelStart,f):H(this._bevelStart,f);I(xt.x,xt.y,-f.x,-f.y,C.x,C.y);const Ft=I(G.x,G.y,-f.x,-f.y,z.x,z.y);if(ct)break;const rt=U?H(this._bevelEnd,u):J(this._bevelEnd,u);if(tt){const S=this._writeVertex(T,A,M,$,-f.x,-f.y,0,0,0,0,F);P=this._writeVertex(T,A,M,$,u.x,u.y,Z.x,Z.y,C.x,C.y,F),E=this._writeVertex(T,A,M,$,u.x,u.y,rt.x,rt.y,z.x,z.y,F),this._writeTriangle(Ft,S,E)}else{if(v){const S=this._bevelMiddle;S.x=(G.x+rt.x)/2,S.y=(G.y+rt.y)/2,Lt(D,S,-f.x,-f.y),I(S.x,S.y,-f.x,-f.y,D.x,D.y),Lt(D,S,u.x,u.y),P=this._writeVertex(T,A,M,$,u.x,u.y,S.x,S.y,D.x,D.y,F),E=this._writeVertex(T,A,M,$,u.x,u.y,Z.x,Z.y,C.x,C.y,F)}else{const S=P;P=E,E=S}I(rt.x,rt.y,u.x,u.y,z.x,z.y)}if(U){const S=P;P=E,E=S}break}case it.ROUND:{const U=nt<0;let C,z;if(U){const X=P;P=E,E=X,C=Vt,z=Nt}else C=Nt,z=Vt;const xt=U?Yt(this._inner,V):ti(this._inner,V);let Z,G;tt?(Z=U?H(this._innerPrev,f):J(this._innerPrev,f),G=U?J(this._innerNext,u):H(this._innerNext,u)):(Z=xt,G=xt);const Ft=U?J(this._roundStart,f):H(this._roundStart,f),rt=U?H(this._roundEnd,u):J(this._roundEnd,u),S=I(Z.x,Z.y,-f.x,-f.y,C.x,C.y),St=I(Ft.x,Ft.y,-f.x,-f.y,z.x,z.y);if(ct)break;const ut=this._writeVertex(T,A,M,$,-f.x,-f.y,0,0,0,0,F);tt||this._writeTriangle(P,E,ut);const ot=Yt(this._outer,xt),ft=this._writeVertex(T,A,M,$,u.x,u.y,rt.x,rt.y,z.x,z.y,F);let Tt,pt;const Mt=j>2;if(Mt){let X;j!==Number.MAX_VALUE?(ot.x/=j,ot.y/=j,X=ii(f,ot),X=(j*(X*X-1)+1)/X):X=-1,Tt=U?J(this._startBreak,f):H(this._startBreak,f),Tt.x+=f.x*X,Tt.y+=f.y*X,pt=U?H(this._endBreak,u):J(this._endBreak,u),pt.x+=u.x*X,pt.y+=u.y*X}Lt(D,ot,-f.x,-f.y);const $t=this._writeVertex(T,A,M,$,-f.x,-f.y,ot.x,ot.y,D.x,D.y,F);Lt(D,ot,u.x,u.y);const qt=v?this._writeVertex(T,A,M,$,u.x,u.y,ot.x,ot.y,D.x,D.y,F):$t,Ht=ut,Pt=v?this._writeVertex(T,A,M,$,u.x,u.y,0,0,0,0,F):ut;let vt=-1,Rt=-1;if(Mt&&(Lt(D,Tt,-f.x,-f.y),vt=this._writeVertex(T,A,M,$,-f.x,-f.y,Tt.x,Tt.y,D.x,D.y,F),Lt(D,pt,u.x,u.y),Rt=this._writeVertex(T,A,M,$,u.x,u.y,pt.x,pt.y,D.x,D.y,F)),v?Mt?(this._writeTriangle(Ht,St,vt),this._writeTriangle(Ht,vt,$t),this._writeTriangle(Pt,qt,Rt),this._writeTriangle(Pt,Rt,ft)):(this._writeTriangle(Ht,St,$t),this._writeTriangle(Pt,qt,ft)):Mt?(this._writeTriangle(ut,St,vt),this._writeTriangle(ut,vt,Rt),this._writeTriangle(ut,Rt,ft)):(this._writeTriangle(ut,St,$t),this._writeTriangle(ut,qt,ft)),tt?(P=this._writeVertex(T,A,M,$,u.x,u.y,G.x,G.y,C.x,C.y,F),E=ft):(P=v?this._writeVertex(T,A,M,$,u.x,u.y,G.x,G.y,C.x,C.y,F):S,this._writeTriangle(P,Pt,ft),E=ft),U){const X=P;P=E,E=X}break}}}}}const It=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["\xAB","\xBB"],["\xBB","\xAB"],["\u2039","\u203A"],["\u203A","\u2039"],["\u207D","\u207E"],["\u207E","\u207D"],["\u208D","\u208E"],["\u208E","\u208D"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232A"],["\u232A","\u2329"],["\uFE59","\uFE5A"],["\uFE5A","\uFE59"],["\uFE5B","\uFE5C"],["\uFE5C","\uFE5B"],["\uFE5D","\uFE5E"],["\uFE5E","\uFE5D"],["\uFE64","\uFE65"],["\uFE65","\uFE64"]],At=["\u0622","\u0623","\u0625","\u0627"],vi=["\uFEF5","\uFEF7","\uFEF9","\uFEFB"],Ri=["\uFEF6","\uFEF8","\uFEFA","\uFEFC"],Ot=["\u0627","\u0628","\u062A","\u062B","\u062C","\u062D","\u062E","\u062F","\u0630","\u0631","\u0632","\u0633","\u0634","\u0635","\u0636","\u0637","\u0638","\u0639","\u063A","\u0641","\u0642","\u0643","\u0644","\u0645","\u0646","\u0647","\u0648","\u064A","\u0625","\u0623","\u0622","\u0629","\u0649","\u0644","\u0645","\u0646","\u0647","\u0648","\u064A","\u0625","\u0623","\u0622","\u0629","\u0649","\u06CC","\u0626","\u0624"],bi=["\uFE8D","\uFE8F","\uFE95","\uFE99","\uFE9D","\uFEA1","\uFEA5","\uFEA9","\uFEAB","\uFEAD","\uFEAF","\uFEB1","\uFEB5","\uFEB9","\uFEBD","\uFEC1","\uFEC5","\uFEC9","\uFECD","\uFED1","\uFED5","\uFED9","\uFEDD","\uFEE1","\uFEE5","\uFEE9","\uFEED","\uFEF1","\uFE87","\uFE83","\uFE81","\uFE93","\uFEEF","\uFBFC","\uFE89","\uFE85","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE89","\uFE85"],Bi=["\uFE8E","\uFE90","\uFE96","\uFE9A","\uFE9E","\uFEA2","\uFEA6","\uFEAA","\uFEAC","\uFEAE","\uFEB0","\uFEB2","\uFEB6","\uFEBA","\uFEBE","\uFEC2","\uFEC6","\uFECA","\uFECE","\uFED2","\uFED6","\uFEDA","\uFEDE","\uFEE2","\uFEE6","\uFEEA","\uFEEE","\uFEF2","\uFE88","\uFE84","\uFE82","\uFE94","\uFEF0","\uFBFD","\uFE8A","\uFE86","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE8A","\uFE86"],Ui=["\uFE8E","\uFE92","\uFE98","\uFE9C","\uFEA0","\uFEA4","\uFEA8","\uFEAA","\uFEAC","\uFEAE","\uFEB0","\uFEB4","\uFEB8","\uFEBC","\uFEC0","\uFEC4","\uFEC8","\uFECC","\uFED0","\uFED4","\uFED8","\uFEDC","\uFEE0","\uFEE4","\uFEE8","\uFEEC","\uFEEE","\uFEF4","\uFE88","\uFE84","\uFE82","\uFE94","\uFEF0","\uFBFF","\uFE8C","\uFE86","\uFE71","\uFE72","\uFE74","\uFE77","\uFE79","\uFE7B","\uFE7D","\uFE7F","\uFE80","\uFE8C","\uFE86"],Vi=["\uFE8D","\uFE91","\uFE97","\uFE9B","\uFE9F","\uFEA3","\uFEA7","\uFEA9","\uFEAB","\uFEAD","\uFEAF","\uFEB3","\uFEB7","\uFEBB","\uFEBF","\uFEC3","\uFEC7","\uFECB","\uFECF","\uFED3","\uFED7","\uFEDB","\uFEDF","\uFEE3","\uFEE7","\uFEEB","\uFEED","\uFEF3","\uFE87","\uFE83","\uFE81","\uFE93","\uFEEF","\uFBFE","\uFE8B","\uFE85","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE8B","\uFE85"],si=["\u0621","\u0622","\u0623","\u0624","\u0625","\u0627","\u0629","\u062F","\u0630","\u0631","\u0632","\u0648","\u0649"],Ni=["\u064B","\u064B","\u064C","\u061F","\u064D","\u061F","\u064E","\u064E","\u064F","\u064F","\u0650","\u0650","\u0651","\u0651","\u0652","\u0652","\u0621","\u0622","\u0622","\u0623","\u0623","\u0624","\u0624","\u0625","\u0625","\u0626","\u0626","\u0626","\u0626","\u0627","\u0627","\u0628","\u0628","\u0628","\u0628","\u0629","\u0629","\u062A","\u062A","\u062A","\u062A","\u062B","\u062B","\u062B","\u062B","\u062C","\u062C","\u062C","\u062C","\u062D","\u062D","\u062D","\u062D","\u062E","\u062E","\u062E","\u062E","\u062F","\u062F","\u0630","\u0630","\u0631","\u0631","\u0632","\u0632","\u0633","\u0633","\u0633","\u0633","\u0634","\u0634","\u0634","\u0634","\u0635","\u0635","\u0635","\u0635","\u0636","\u0636","\u0636","\u0636","\u0637","\u0637","\u0637","\u0637","\u0638","\u0638","\u0638","\u0638","\u0639","\u0639","\u0639","\u0639","\u063A","\u063A","\u063A","\u063A","\u0641","\u0641","\u0641","\u0641","\u0642","\u0642","\u0642","\u0642","\u0643","\u0643","\u0643","\u0643","\u0644","\u0644","\u0644","\u0644","\u0645","\u0645","\u0645","\u0645","\u0646","\u0646","\u0646","\u0646","\u0647","\u0647","\u0647","\u0647","\u0648","\u0648","\u0649","\u0649","\u064A","\u064A","\u064A","\u064A","\uFEF5","\uFEF6","\uFEF7","\uFEF8","\uFEF9","\uFEFA","\uFEFB","\uFEFC","\u061F","\u061F","\u061F"],ei=["\u0621","\u0641"],Ei=["\u063A","\u064A"],Fi=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],Si=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],s=0,_=1,p=2,N=3,t=4,et=5,Ct=6,i=7,O=8,W=9,K=10,L=11,r=12,Mi=13,$i=14,Pi=15,Ii=16,Di=17,g=18,ki=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],st=100,Ci=[st+0,s,s,s,s,st+1,st+2,st+3,_,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,st+4,t,t,t,s,t,s,t,s,t,t,t,s,s,t,t,s,s,s,s,s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,s,t,t,s,s,t,t,s,s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,s,s,st+5,i,i,st+6,st+7],Oi=[[g,g,g,g,g,g,g,g,g,Ct,et,Ct,O,et,g,g,g,g,g,g,g,g,g,g,g,g,g,g,et,et,et,Ct,O,t,t,L,L,L,t,t,t,t,t,K,W,K,W,W,p,p,p,p,p,p,p,p,p,p,W,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,g,g,g,g,g,g,et,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,W,t,L,L,L,L,t,t,t,t,s,t,t,g,t,t,L,L,p,p,t,s,t,t,t,p,s,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,s,s,s,s,s,s,s,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,s,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,_,r,_,r,r,_,r,r,_,r,t,t,t,t,t,t,t,t,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,t,t,t,t,t,_,_,_,_,_,t,t,t,t,t,t,t,t,t,t,t],[N,N,N,N,t,t,t,t,i,L,L,i,W,i,t,t,r,r,r,r,r,r,r,r,r,r,r,i,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,N,N,N,N,N,N,N,N,N,N,L,N,N,i,i,i,r,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,N,t,r,r,r,r,r,r,i,i,r,r,t,r,r,r,r,i,i,p,p,p,p,p,p,p,p,p,p,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,i,i,r,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,r,r,r,r,i,t,t,t,t,t,t,t,t,t,t,t,t,t,t,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,r,r,r,r,r,r,r,r,r,_,_,t,t,t,t,_,t,t,t,t,t],[O,O,O,O,O,O,O,O,O,O,O,g,g,g,s,_,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,O,et,Mi,$i,Pi,Ii,Di,W,L,L,L,L,L,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,W,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,O,g,g,g,g,g,t,t,t,t,t,g,g,g,g,g,g,p,s,t,t,p,p,p,p,p,p,K,K,t,t,t,s,p,p,p,p,p,p,p,p,p,p,K,K,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[s,s,s,s,s,s,s,t,t,t,t,t,t,t,t,t,t,t,t,s,s,s,s,s,t,t,t,t,t,_,r,_,_,_,_,_,_,_,_,_,_,K,_,_,_,_,_,_,_,_,_,_,_,_,_,t,_,_,_,_,_,t,_,t,_,_,t,_,_,t,_,_,_,_,_,_,_,_,_,_,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,W,t,W,t,t,W,t,t,t,t,t,t,t,t,t,L,t,t,K,K,t,t,t,t,t,L,L,t,t,t,t,t,i,i,i,i,i,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,t,g],[t,t,t,L,L,L,t,t,t,t,t,K,W,K,W,W,p,p,p,p,p,p,p,p,p,p,W,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,s,s,s,s,s,s,t,t,s,s,s,s,s,s,t,t,s,s,s,s,s,s,t,t,s,s,s,t,t,t,L,L,t,t,t,L,L,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];class ps{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(e,n,o){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if(ns(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(n,o))return e;n=this.inputFormat,o=this.outputFormat;let a=e;const l=rs,x=ri(n.charAt(1)),c=ri(o.charAt(1)),y=(n.charAt(0)==="I"?"L":n.charAt(0))+x,m=(o.charAt(0)==="I"?"L":o.charAt(0))+c,R=n.charAt(2)+o.charAt(2);l.defInFormat=y,l.defOutFormat=m,l.defSwap=R;const B=bt(e,y,m,R,l);let w=!1;return o.charAt(1)==="R"?w=!0:o.charAt(1)!=="C"&&o.charAt(1)!=="D"||(w=this.checkContextual(B)==="rtl"),this.sourceToTarget=q,this.targetToSource=hs(this.sourceToTarget),zt=this.targetToSource,a=n.charAt(3)===o.charAt(3)?B:o.charAt(3)==="S"?zi(w,B,!0):qi(B,w,!0),this.sourceToTarget=q,this.targetToSource=zt,this.levels=Wt,a}_inputFormatSetter(e){if(!oi.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e}_outputFormatSetter(e){if(!oi.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e}checkParameters(e,n){return e?this._inputFormatSetter(e):e=this.inputFormat,n?this._outputFormatSetter(n):n=this.outputFormat,e!==n}checkContextual(e){let n=jt(e);if(n!=="ltr"&&n!=="rtl"){try{n=document.dir.toLowerCase()}catch{}n!=="ltr"&&n!=="rtl"&&(n="ltr")}return n}hasBidiChar(e){return ls.test(e)}}function bt(h,e,n,o,a){const l=ji(h,{inFormat:e,outFormat:n,swap:o},a);if(l.inFormat===l.outFormat)return h;e=l.inFormat,n=l.outFormat,o=l.swap;const x=e.substring(0,1),c=e.substring(1,4),y=n.substring(0,1),m=n.substring(1,4);if(a.inFormat=e,a.outFormat=n,a.swap=o,x==="L"&&n==="VLTR"){if(c==="LTR")return a.dir=wt,yt(h,a);if(c==="RTL")return a.dir=Bt,yt(h,a)}if(x==="V"&&y==="V")return a.dir=c==="RTL"?Bt:wt,Gt(h,a);if(x==="L"&&n==="VRTL")return c==="LTR"?(a.dir=wt,h=yt(h,a)):(a.dir=Bt,h=yt(h,a)),Gt(h);if(e==="VLTR"&&n==="LLTR")return a.dir=wt,yt(h,a);if(x==="V"&&y==="L"&&c!==m)return h=Gt(h),c==="RTL"?bt(h,"LLTR","VLTR",o,a):bt(h,"LRTL","VRTL",o,a);if(e==="VRTL"&&n==="LRTL")return bt(h,"LRTL","VRTL",o,a);if(x==="L"&&y==="L"){const R=a.swap;return a.swap=R.substr(0,1)+"N",c==="RTL"?(a.dir=Bt,h=yt(h,a),a.swap="N"+R.substr(1,2),a.dir=wt,h=yt(h,a)):(a.dir=wt,h=yt(h,a),a.swap="N"+R.substr(1,2),h=bt(h,"VLTR","LRTL",a.swap,a)),h}return h}function ji(h,e,n){if(e.inFormat===void 0&&(e.inFormat=n.defInFormat),e.outFormat===void 0&&(e.outFormat=n.defOutFormat),e.swap===void 0&&(e.swap=n.defSwap),e.inFormat===e.outFormat)return e;const o=e.inFormat.substring(0,1),a=e.outFormat.substring(0,1);let l,x=e.inFormat.substring(1,4),c=e.outFormat.substring(1,4);return x.charAt(0)==="C"&&(l=jt(h),x=l==="ltr"||l==="rtl"?l.toUpperCase():e.inFormat.charAt(2)==="L"?"LTR":"RTL",e.inFormat=o+x),c.charAt(0)==="C"&&(l=jt(h),l==="rtl"?c="RTL":l==="ltr"?(l=Xi(h),c=l.toUpperCase()):c=e.outFormat.charAt(2)==="L"?"LTR":"RTL",e.outFormat=a+c),e}function zi(h,e,n){if(e.length===0)return"";h===void 0&&(h=!0),n===void 0&&(n=!0);const o=(e=String(e)).split("");let a=0,l=1,x=o.length;h||(a=o.length-1,l=-1,x=1);const c=Wi(o,a,l,x,n);let y="";for(let m=0;m<o.length;m++)n&&Zi(c,c.length,m)>-1?(ui(zt,m,!h,-1),q.splice(m,1)):y+=o[m];return y}function Wi(h,e,n,o,a){let l=0;const x=[];let c=0;for(let y=e;y*n<o;y+=n)if(xi(h[y])||Ut(h[y])){if(h[y]==="\u0644"&&Gi(h,y+n,n,o)){h[y]=es(h[y+n],l===0?vi:Ri),y+=n,ss(h,y,n,o),a&&(x[c]=y,c++),l=0;continue}const m=h[y];l===1?h[y]=ni(h,y+n,n,o)?is(h[y]):Jt(h[y],Bi):ni(h,y+n,n,o)===!0?h[y]=Jt(h[y],Vi):h[y]=Jt(h[y],bi),Ut(m)||(l=1),ts(m)===!0&&(l=0)}else l=0;return x}function jt(h){const e=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(h);return e?e[0]<="z"?"ltr":"rtl":""}function Xi(h){const e=h.split("");return e.reverse(),jt(e.join(""))}function qi(h,e,n){if(h.length===0)return"";n===void 0&&(n=!0),e===void 0&&(e=!0);let o="";const a=(h=String(h)).split("");for(let l=0;l<h.length;l++){let x=!1;if(a[l]>="\uFE70"&&a[l]<"\uFEFF"){const c=h.charCodeAt(l);a[l]>="\uFEF5"&&a[l]<="\uFEFC"?(e?(l>0&&n&&a[l-1]===" "?o=o.substring(0,o.length-1)+"\u0644":(o+="\u0644",x=!0),o+=At[(c-65269)/2]):(o+=At[(c-65269)/2],o+="\u0644",l+1<h.length&&n&&a[l+1]===" "?l++:x=!0),x&&(ui(zt,l,!0,1),q.splice(l,0,q[l]))):o+=Ni[c-65136]}else o+=a[l]}return o}function yt(h,e){const n=h.split(""),o=[];return _i(n,o,e),Qi(n,o,e),hi(2,n,o,e),hi(1,n,o,e),Wt=o,n.join("")}function _i(h,e,n){const o=h.length,a=n.dir?Si:Fi;let l=0,x=-1;const c=[],y=[];n.hiLevel=n.dir,n.lastArabic=!1,n.hasUbatAl=!1,n.hasUbatB=!1,n.hasUbatS=!1;for(let m=0;m<o;m++)c[m]=Yi(h[m]);for(let m=0;m<o;m++){const R=l,B=Ji(h,c,y,m,n);y[m]=B,l=a[R][B];const w=240&l;l&=15;const v=a[l][os];if(e[m]=v,w>0)if(w===16){for(let d=x;d<m;d++)e[d]=1;x=-1}else x=-1;if(a[l][as])x===-1&&(x=m);else if(x>-1){for(let d=x;d<m;d++)e[d]=v;x=-1}c[m]===et&&(e[m]=0),n.hiLevel|=v}n.hasUbatS&&Hi(c,e,o,n)}function Hi(h,e,n,o){for(let a=0;a<n;a++)if(h[a]===Ct){e[a]=o.dir;for(let l=a-1;l>=0&&h[l]===O;l--)e[l]=o.dir}}function Qi(h,e,n){if(n.hiLevel!==0&&n.swap.substr(0,1)!==n.swap.substr(1,2))for(let o=0;o<h.length;o++)e[o]===1&&(h[o]=Ki(h[o]))}function Yi(h){const e=h.charCodeAt(0),n=Ci[e>>8];return n<st?n:Oi[n-st][255&e]}function Gt(h,e){const n=h.split("");if(e){const o=[];_i(n,o,e),Wt=o}return n.reverse(),q.reverse(),n.join("")}function Zi(h,e,n){for(let o=0;o<e;o++)if(h[o]===n)return o;return-1}function xi(h){for(let e=0;e<ei.length;e++)if(h>=ei[e]&&h<=Ei[e])return!0;return!1}function ni(h,e,n,o){for(;e*n<o&&Ut(h[e]);)e+=n;return!!(e*n<o&&xi(h[e]))}function Gi(h,e,n,o){for(;e*n<o&&Ut(h[e]);)e+=n;let a=" ";if(!(e*n<o))return!1;a=h[e];for(let l=0;l<At.length;l++)if(At[l]===a)return!0;return!1}function hi(h,e,n,o){if(o.hiLevel<h)return;if(h===1&&o.dir===Bt&&!o.hasUbatB)return e.reverse(),void q.reverse();const a=e.length;let l,x,c,y,m,R=0;for(;R<a;){if(n[R]>=h){for(l=R+1;l<a&&n[l]>=h;)l++;for(x=R,c=l-1;x<c;x++,c--)y=e[x],e[x]=e[c],e[c]=y,m=q[x],q[x]=q[c],q[c]=m;R=l}R++}}function Ji(h,e,n,o,a){const l=e[o];return{UBAT_L:()=>(a.lastArabic=!1,s),UBAT_R:()=>(a.lastArabic=!1,_),UBAT_ON:()=>t,UBAT_AN:()=>N,UBAT_EN:()=>a.lastArabic?N:p,UBAT_AL:()=>(a.lastArabic=!0,a.hasUbatAl=!0,_),UBAT_WS:()=>t,UBAT_CS:()=>{let x,c;return o<1||o+1>=e.length||(x=n[o-1])!==p&&x!==N||(c=e[o+1])!==p&&c!==N?t:(a.lastArabic&&(c=N),c===x?c:t)},UBAT_ES:()=>(o>0?n[o-1]:et)===p&&o+1<e.length&&e[o+1]===p?p:t,UBAT_ET:()=>{if(o>0&&n[o-1]===p)return p;if(a.lastArabic)return t;let x=o+1;const c=e.length;for(;x<c&&e[x]===L;)x++;return x<c&&e[x]===p?p:t},UBAT_NSM:()=>{if(a.inFormat==="VLTR"){const x=e.length;let c=o+1;for(;c<x&&e[c]===r;)c++;if(c<x){const y=h[o].charCodeAt[0],m=y>=1425&&y<=2303||y===64286,R=e[c];if(m&&(R===_||R===i))return _}}return o<1||e[o-1]===et?t:n[o-1]},UBAT_B:()=>(a.lastArabic=!0,a.hasUbatB=!0,a.dir),UBAT_S:()=>(a.hasUbatS=!0,t),UBAT_LRE:()=>(a.lastArabic=!1,t),UBAT_RLE:()=>(a.lastArabic=!1,t),UBAT_LRO:()=>(a.lastArabic=!1,t),UBAT_RLO:()=>(a.lastArabic=!1,t),UBAT_PDF:()=>(a.lastArabic=!1,t),UBAT_BN:()=>t}[ki[l]]()}function Ki(h){let e,n=0,o=It.length-1;for(;n<=o;)if(e=Math.floor((n+o)/2),h<It[e][0])o=e-1;else{if(!(h>It[e][0]))return It[e][1];n=e+1}return h}function ts(h){for(let e=0;e<si.length;e++)if(si[e]===h)return!0;return!1}function is(h){for(let e=0;e<Ot.length;e++)if(h===Ot[e])return Ui[e];return h}function Jt(h,e){for(let n=0;n<Ot.length;n++)if(h===Ot[n])return e[n];return h}function Ut(h){return h>="\u064B"&&h<="\u0655"}function ri(h){return h==="L"?"LTR":h==="R"?"RTL":h==="C"?"CLR":h==="D"?"CRL":""}function ss(h,e,n,o){for(;e*n<o&&Ut(h[e]);)e+=n;return e*n<o&&(h[e]=" ",!0)}function es(h,e){for(let n=0;n<At.length;n++)if(h===At[n])return e[n];return h}function ns(h,e,n){q=[],Wt=[];for(let o=0;o<n;o++)h[o]=o,e[o]=o,q[o]=o}function hs(h){const e=new Array(h.length);for(let n=0;n<h.length;n++)e[h[n]]=n;return e}function ui(h,e,n,o){for(let a=0;a<h.length;a++)(h[a]>e||!n&&h[a]===e)&&(h[a]+=o)}let q=[],zt=[],Wt=[];const rs={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},os=5,as=6,wt=0,Bt=1,oi=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,ls=/[\u0591-\u06ff\ufb1d-\ufefc]/,_s=Math.PI,xs=128/_s,us=256/360;function yi(h,e){return(h%=e)>=0?h:h+e}function Ls(h){return yi(h*xs,256)}function ws(h){return yi(h*us,256)}function Dt(h,e,n){return h>=e&&h<=n||h>=n&&h<=e}class kt{constructor(e,n,o){this.ratio=e,this.x=n,this.y=o}}class As{constructor(e,n,o,a=8,l=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=a,this._pixelMargin=l,this._tileSize=Ti*a,this._dz=e,this._yPos=n,this._xPos=o}setPixelMargin(e){e!==this._pixelMargin&&(this._pixelMargin=e,this.setExtent(this._extent))}setExtent(e){this._extent=e,this._finalRatio=this._tileSize/e*(1<<this._dz);let n=this._pixelRatio*this._pixelMargin;n/=this._finalRatio;const o=e>>this._dz;n>o&&(n=o),this._margin=n,this._xmin=o*this._xPos-n,this._ymin=o*this._yPos-n,this._xmax=this._xmin+o+2*n,this._ymax=this._ymin+o+2*n}reset(e){this._type=e,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(e,n){this._pushLine(),this._prevIsIn=this._isIn(e,n),this._moveTo(e,n,this._prevIsIn),this._prevPt=new Q(e,n),this._firstPt=new Q(e,n),this._dist=0}lineTo(e,n){const o=this._isIn(e,n),a=new Q(e,n),l=Q.distance(this._prevPt,a);let x,c,y,m,R,B,w,v;if(o)this._prevIsIn?this._lineTo(e,n,!0):(x=this._prevPt,c=a,y=this._intersect(c,x),this._start=this._dist+l*(1-this._r),this._lineTo(y.x,y.y,!0),this._lineTo(c.x,c.y,!0));else if(this._prevIsIn)c=this._prevPt,x=a,y=this._intersect(c,x),this._lineTo(y.x,y.y,!0),this._lineTo(x.x,x.y,!1);else{const d=this._prevPt,T=a;if(d.x<=this._xmin&&T.x<=this._xmin||d.x>=this._xmax&&T.x>=this._xmax||d.y<=this._ymin&&T.y<=this._ymin||d.y>=this._ymax&&T.y>=this._ymax)this._lineTo(T.x,T.y,!1);else{const A=[];if((d.x<this._xmin&&T.x>this._xmin||d.x>this._xmin&&T.x<this._xmin)&&(m=(this._xmin-d.x)/(T.x-d.x),v=d.y+m*(T.y-d.y),v<=this._ymin?B=!1:v>=this._ymax?B=!0:A.push(new kt(m,this._xmin,v))),(d.x<this._xmax&&T.x>this._xmax||d.x>this._xmax&&T.x<this._xmax)&&(m=(this._xmax-d.x)/(T.x-d.x),v=d.y+m*(T.y-d.y),v<=this._ymin?B=!1:v>=this._ymax?B=!0:A.push(new kt(m,this._xmax,v))),(d.y<this._ymin&&T.y>this._ymin||d.y>this._ymin&&T.y<this._ymin)&&(m=(this._ymin-d.y)/(T.y-d.y),w=d.x+m*(T.x-d.x),w<=this._xmin?R=!1:w>=this._xmax?R=!0:A.push(new kt(m,w,this._ymin))),(d.y<this._ymax&&T.y>this._ymax||d.y>this._ymax&&T.y<this._ymax)&&(m=(this._ymax-d.y)/(T.y-d.y),w=d.x+m*(T.x-d.x),w<=this._xmin?R=!1:w>=this._xmax?R=!0:A.push(new kt(m,w,this._ymax))),A.length===0)R?B?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):B?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(A.length>1&&A[0].ratio>A[1].ratio)this._start=this._dist+l*A[1].ratio,this._lineTo(A[1].x,A[1].y,!0),this._lineTo(A[0].x,A[0].y,!0);else{this._start=this._dist+l*A[0].ratio;for(let b=0;b<A.length;b++)this._lineTo(A[b].x,A[b].y,!0)}this._lineTo(T.x,T.y,!1)}}this._dist+=l,this._prevIsIn=o,this._prevPt=a}close(){if(this._line.length>2){const e=this._firstPt,n=this._prevPt;e.x===n.x&&e.y===n.y||this.lineTo(e.x,e.y);const o=this._line;let a=o.length;for(;a>=4&&(o[0].x===o[1].x&&o[0].x===o[a-2].x||o[0].y===o[1].y&&o[0].y===o[a-2].y);)o.pop(),o[0].x=o[a-2].x,o[0].y=o[a-2].y,--a}}result(e=!0){return this._pushLine(),this._lines.length===0?null:(this._type===mt.Polygon&&e&&lt.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==mt.LineString)throw new Error("Only valid for lines");this._pushLine();const e=this._lines,n=e.length;if(n===0)return null;const o=[];for(let a=0;a<n;a++)o.push({line:e[a],start:this._starts[a]||0});return o}_isIn(e,n){return e>=this._xmin&&e<=this._xmax&&n>=this._ymin&&n<=this._ymax}_intersect(e,n){let o,a,l;if(n.x>=this._xmin&&n.x<=this._xmax)a=n.y<=this._ymin?this._ymin:this._ymax,l=(a-e.y)/(n.y-e.y),o=e.x+l*(n.x-e.x);else if(n.y>=this._ymin&&n.y<=this._ymax)o=n.x<=this._xmin?this._xmin:this._xmax,l=(o-e.x)/(n.x-e.x),a=e.y+l*(n.y-e.y);else{a=n.y<=this._ymin?this._ymin:this._ymax,o=n.x<=this._xmin?this._xmin:this._xmax;const x=(o-e.x)/(n.x-e.x),c=(a-e.y)/(n.y-e.y);x<c?(l=x,a=e.y+x*(n.y-e.y)):(l=c,o=e.x+c*(n.x-e.x))}return this._r=l,new Q(o,a)}_pushLine(){this._line&&(this._type===mt.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===mt.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===mt.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(e,n,o){this._type!==mt.Polygon?o&&(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),n=Math.round((n-(this._ymin+this._margin))*this._finalRatio),this._line.push(new Q(e,n))):(o||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),n<this._ymin&&(n=this._ymin),n>this._ymax&&(n=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),n=Math.round((n-(this._ymin+this._margin))*this._finalRatio),this._line.push(new Q(e,n)),this._isH=!1,this._isV=!1)}_lineTo(e,n,o){let a,l;if(this._type!==mt.Polygon)if(o){if(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),n=Math.round((n-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(a=this._line[this._line.length-1],a.equals(e,n)))return;this._line.push(new Q(e,n))}else this._line&&this._line.length>0&&this._pushLine();else if(o||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),n<this._ymin&&(n=this._ymin),n>this._ymax&&(n=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),n=Math.round((n-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){a=this._line[this._line.length-1];const x=a.x===e,c=a.y===n;if(x&&c)return;this._isH&&x||this._isV&&c?(a.x=e,a.y=n,l=this._line[this._line.length-2],l.x===e&&l.y===n?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(l=this._line[this._line.length-2],this._isH=l.x===e,this._isV=l.y===n)):(this._isH=l.x===e,this._isV=l.y===n)):(this._line.push(new Q(e,n)),this._isH=x,this._isV=c)}else this._line.push(new Q(e,n))}}class vs{setExtent(e){this._ratio=e===4096?1:4096/e}get validateTessellation(){return this._ratio<1}reset(e){this._lines=[],this._line=null}moveTo(e,n){this._line&&this._lines.push(this._line),this._line=[];const o=this._ratio;this._line.push(new Q(e*o,n*o))}lineTo(e,n){const o=this._ratio;this._line.push(new Q(e*o,n*o))}close(){const e=this._line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}result(){return this._line&&this._lines.push(this._line),this._lines.length===0?null:this._lines}}var k;(function(h){h[h.sideLeft=0]="sideLeft",h[h.sideRight=1]="sideRight",h[h.sideTop=2]="sideTop",h[h.sideBottom=3]="sideBottom"})(k||(k={}));class lt{static simplify(e,n,o){if(!o)return;const a=-n,l=e+n,x=-n,c=e+n,y=[],m=[],R=o.length;for(let w=0;w<R;++w){const v=o[w];if(!v||v.length<2)continue;let d,T=v[0];const A=v.length;for(let b=1;b<A;++b)d=v[b],T.x===d.x&&(T.x<=a&&(T.y>d.y?(y.push(w),y.push(b),y.push(k.sideLeft),y.push(-1)):(m.push(w),m.push(b),m.push(k.sideLeft),m.push(-1))),T.x>=l&&(T.y<d.y?(y.push(w),y.push(b),y.push(k.sideRight),y.push(-1)):(m.push(w),m.push(b),m.push(k.sideRight),m.push(-1)))),T.y===d.y&&(T.y<=x&&(T.x<d.x?(y.push(w),y.push(b),y.push(k.sideTop),y.push(-1)):(m.push(w),m.push(b),m.push(k.sideTop),m.push(-1))),T.y>=c&&(T.x>d.x?(y.push(w),y.push(b),y.push(k.sideBottom),y.push(-1)):(m.push(w),m.push(b),m.push(k.sideBottom),m.push(-1)))),T=d}if(y.length===0||m.length===0)return;lt.fillParent(o,m,y),lt.fillParent(o,y,m);const B=[];lt.calcDeltas(B,m,y),lt.calcDeltas(B,y,m),lt.addDeltas(B,o)}static fillParent(e,n,o){const a=o.length,l=n.length;for(let x=0;x<l;x+=4){const c=n[x],y=n[x+1],m=n[x+2],R=e[c][y-1],B=e[c][y];let w=8092,v=-1;for(let d=0;d<a;d+=4){if(o[d+2]!==m)continue;const T=o[d],A=o[d+1],b=e[T][A-1],f=e[T][A];switch(m){case k.sideLeft:case k.sideRight:if(Dt(R.y,b.y,f.y)&&Dt(B.y,b.y,f.y)){const u=Math.abs(f.y-b.y);u<w&&(w=u,v=d)}break;case k.sideTop:case k.sideBottom:if(Dt(R.x,b.x,f.x)&&Dt(B.x,b.x,f.x)){const u=Math.abs(f.x-b.x);u<w&&(w=u,v=d)}}}n[x+3]=v}}static calcDeltas(e,n,o){const a=n.length;for(let l=0;l<a;l+=4){const x=[],c=lt.calcDelta(l,n,o,x);e.push(n[l]),e.push(n[l+1]),e.push(n[l+2]),e.push(c)}}static calcDelta(e,n,o,a){const l=n[e+3];if(l===-1)return 0;const x=a.length;return x>1&&a[x-2]===l?0:(a.push(l),lt.calcDelta(l,o,n,a)+1)}static addDeltas(e,n){const o=e.length;let a=0;for(let l=0;l<o;l+=4){const x=e[l+3];x>a&&(a=x)}for(let l=0;l<o;l+=4){const x=n[e[l]],c=e[l+1],y=a-e[l+3];switch(e[l+2]){case k.sideLeft:x[c-1].x-=y,x[c].x-=y,c===1&&(x[x.length-1].x-=y),c===x.length-1&&(x[0].x-=y);break;case k.sideRight:x[c-1].x+=y,x[c].x+=y,c===1&&(x[x.length-1].x+=y),c===x.length-1&&(x[0].x+=y);break;case k.sideTop:x[c-1].y-=y,x[c].y-=y,c===1&&(x[x.length-1].y-=y),c===x.length-1&&(x[0].y-=y);break;case k.sideBottom:x[c-1].y+=y,x[c].y+=y,c===1&&(x[x.length-1].y+=y),c===x.length-1&&(x[0].y+=y)}}}}export{ps as C,ws as M,vs as _,Ts as c,Ls as h,ds as i,As as n,gs as r,ms as t};
